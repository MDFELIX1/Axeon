<script>
    // --- AUTHENTICATION & SESSION SYSTEM ---
    const ADMIN_PASS = "aA123##q";
    
    // Initialize Database from LocalStorage
    let db = JSON.parse(localStorage.getItem('axeon_db')) || {
        settings: {
            bank: "Moniepoint",
            account: "8123456789",
            mtn: 300,
            airtel: 320,
            discount: 2
        },
        logs: []
    };

    function saveDB() {
        localStorage.setItem('axeon_db', JSON.stringify(db));
    }

    // --- REALISTIC LOGIN PROCESS ---
    async function loginUser() {
        let user = document.getElementById('usernameInput').value.trim();
        if(!user) return alert("Enter a valid username");

        // Simulate a real server check
        const btn = document.querySelector('.btn');
        btn.innerText = "Authenticating...";
        btn.disabled = true;

        setTimeout(() => {
            let id = Math.floor(100000 + Math.random() * 900000);
            sessionStorage.setItem('active_user', JSON.stringify({name: user, id: id}));
            logActivity(`User ${user} logged in.`);
            loadUserDashboard();
        }, 1500); // Realistic delay
    }

    function promptAdmin() {
        let entry = prompt("SECURITY CHALLENGE: Enter Admin Password");
        if(entry === ADMIN_PASS) {
            logActivity("Admin access granted.");
            loadAdminDashboard();
        } else {
            logActivity("FAILED Admin login attempt.");
            alert("Unauthorized Access Detected.");
        }
    }

    // --- ADMIN ACTIONS ---
    function saveAdminData() {
        db.settings.bank = document.getElementById('adminBankName').value;
        db.settings.account = document.getElementById('adminAccNum').value;
        db.settings.mtn = document.getElementById('adminMtnPrice').value;
        db.settings.airtel = document.getElementById('adminAirtelPrice').value;
        db.settings.discount = document.getElementById('adminAirtime').value;
        
        saveDB();
        logActivity("Admin updated system rates and bank details.");
        alert("System Synchronized Successfully.");
        loadUserDashboard(); // Refresh UI
    }

    function logActivity(msg) {
        const time = new Date().toLocaleTimeString();
        db.logs.unshift(`[${time}] ${msg}`);
        if(db.logs.length > 10) db.logs.pop(); // Keep only last 10
        saveDB();
    }

    // Initialize UI on page load
    window.onload = () => {
        if(sessionStorage.getItem('active_user')) loadUserDashboard();
    };
</script>

